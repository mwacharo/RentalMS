import{_ as A}from"./AppLayout-DLV5K9WW.js";import S from"./RolePermissions-Becumj0n.js";import{h as a,c as N,o as O,w as l,b as t,i as U,f as n,m as k,q as z,a as L,t as j,j as r}from"./app-Cdoi5j0A.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={components:{AppLayout:A,RolesPermissions:S},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:" Name",align:"start",sortable:!1,key:"name"},{title:"Actions",key:"actions",sortable:!1}],roles:[],searchQuery:"",editedIndex:-1,editedItem:{name:"",email:"",phone:""},defaultItem:{name:"",email:"",phone:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Role":"Edit Role"}},watch:{dialog(o){o||this.close()},dialogDelete(o){o||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){r.get("/v1/roles").then(e=>{console.log("API Response:",e.data),this.roles=e.data}).catch(e=>{console.error("API Error:",e)})},managePermissions(o){this.$refs.RolesPermissionsComponent.showDialog(o.id)},editItem(o){this.editedIndex=this.roles.indexOf(o),this.editedItem=Object.assign({},o),this.dialog=!0},deleteItem(o){this.editedIndex=this.roles.indexOf(o),this.editedItem=Object.assign({},o),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/v1/roles/${this.editedItem.id}`).then(()=>{this.roles.splice(this.editedIndex,1),this.closeDelete()}).catch(o=>console.error("Deletion error:",o))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let o;this.editedIndex>-1?o=r.put(`/v1/roles/${this.editedItem.id}`,this.editedItem):o=r.post("/v1/roles",this.editedItem),o.then(e=>{this.editedIndex>-1?Object.assign(this.roles[this.editedIndex],e.data.data):this.roles.push(e.data.data),this.close()}).catch(e=>console.error("Saving error:",e)),this.close()},performSearch(){this.loading=!0;const o="/roles/search?query="+this.searchQuery;r.get(o).then(e=>{console.log("Search response:",e.data),this.roles=e.data,this.loading=!1}).catch(e=>{console.error("Search error:",e),this.loading=!1})}}},q={class:"text-h5"};function B(o,e,F,T,E,i){const u=a("v-text-field"),f=a("v-container"),_=a("VCard"),C=a("v-toolbar-title"),b=a("v-divider"),m=a("v-spacer"),d=a("v-btn"),p=a("v-card-title"),y=a("v-col"),x=a("v-row"),V=a("v-card-text"),v=a("v-card-actions"),h=a("v-card"),g=a("v-dialog"),R=a("v-toolbar"),c=a("v-icon"),D=a("v-data-table"),P=a("RolesPermissions"),w=a("AppLayout");return O(),N(w,null,{default:l(()=>[t(_,{class:"my-card"},{default:l(()=>[t(f,null,{default:l(()=>[t(u,{modelValue:o.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=s=>o.searchQuery=s),label:"Search",onKeyup:U(i.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(_,{class:"my-card",outlined:""},{default:l(()=>[t(D,{headers:o.headers,loading:o.loading,items:o.roles,"sort-by":[{key:"name",order:"asc"}]},{top:l(()=>[t(R,{flat:""},{default:l(()=>[t(C,null,{default:l(()=>e[4]||(e[4]=[n("Role")])),_:1}),t(b,{class:"mx-4",inset:"",vertical:""}),t(m),t(g,{modelValue:o.dialog,"onUpdate:modelValue":e[2]||(e[2]=s=>o.dialog=s),"max-width":"500px"},{activator:l(({props:s})=>[t(d,k({color:"primary",dark:"",class:"mb-2"},s),{default:l(()=>e[5]||(e[5]=[n(" New Role ")])),_:2},1040)]),default:l(()=>[t(h,null,{default:l(()=>[t(p,null,{default:l(()=>[L("span",q,j(i.formTitle),1)]),_:1}),t(V,null,{default:l(()=>[t(f,null,{default:l(()=>[t(x,null,{default:l(()=>[t(y,{cols:"12"},{default:l(()=>[t(u,{modelValue:o.editedItem.name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.editedItem.name=s),label:" Name"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(v,null,{default:l(()=>[t(m),t(d,{color:"blue-darken-1",variant:"text",onClick:i.close},{default:l(()=>e[6]||(e[6]=[n(" Cancel ")])),_:1},8,["onClick"]),t(d,{color:"blue-darken-1",variant:"text",onClick:i.save},{default:l(()=>e[7]||(e[7]=[n(" Save ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(g,{modelValue:o.dialogDelete,"onUpdate:modelValue":e[3]||(e[3]=s=>o.dialogDelete=s),"max-width":"500px"},{default:l(()=>[t(h,null,{default:l(()=>[t(p,{class:"text-h5"},{default:l(()=>e[8]||(e[8]=[n("Are you sure you want to delete this item?")])),_:1}),t(v,null,{default:l(()=>[t(m),t(d,{color:"blue-darken-1",variant:"text",onClick:i.closeDelete},{default:l(()=>e[9]||(e[9]=[n("Cancel")])),_:1},8,["onClick"]),t(d,{color:"blue-darken-1",variant:"text",onClick:i.deleteItemConfirm},{default:l(()=>e[10]||(e[10]=[n("OK")])),_:1},8,["onClick"]),t(m)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:s})=>[t(c,k(o.attrs,z(o.on),{size:"large",color:"primary",class:"me-2",onClick:I=>i.managePermissions(s)}),{default:l(()=>e[11]||(e[11]=[n(" mdi-account-key ")])),_:2},1040,["onClick"]),t(c,{size:"small",class:"me-2",onClick:I=>i.editItem(s)},{default:l(()=>e[12]||(e[12]=[n(" mdi-pencil ")])),_:2},1032,["onClick"]),t(c,{size:"small",onClick:I=>i.deleteItem(s)},{default:l(()=>e[13]||(e[13]=[n(" mdi-delete ")])),_:2},1032,["onClick"])]),"no-data":l(()=>[t(d,{color:"primary",onClick:i.initialize},{default:l(()=>e[14]||(e[14]=[n(" Reset ")])),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),t(P,{ref:"RolesPermissionsComponent"},null,512)]),_:1})]),_:1})}const M=K(Q,[["render",B],["__scopeId","data-v-926b5523"]]);export{M as default};
