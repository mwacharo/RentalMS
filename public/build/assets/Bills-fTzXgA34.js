import{_ as A}from"./AppLayout-KthpRHFT.js";import{h as u,i,o as B,c as D,w as l,b as e,j as O,f as d,m as S,a as L,t as N}from"./app-QIvPAEsC.js";import{_ as z}from"./_plugin-vue_export-helper-x3n3nnut.js";const P={components:{AppLayout:A},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Bill",align:"start",sortable:!1,key:"bill"},{title:"Unit Cost",key:"unit_cost"},{title:"Number of units",key:"number_of_units"},{title:"Amount",key:"amount"},{title:"Actions",key:"actions",sortable:!1}],bills:[],searchQuery:"",editedIndex:-1,editedItem:{bill:"",amount:"",unit_cost:"",number_of_units:""},defaultItem:{bill:"",amount:"",unit_cost:"",number_of_units:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Bill":"Edit Bill"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){u.get("/v1/billList").then(o=>{console.log("Bills API Response:",o.data),this.bills=o.data}).catch(o=>{console.error("Bill API Error:",o)})},editItem(t){this.editedIndex=this.bills.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.bills.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){u.delete(`/bill/${this.editedItem.id}`).then(()=>{this.bills.splice(this.editedIndex,1),this.$toastr.warning(" deleted"),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?(t=u.put(`/bill/${this.editedItem.id}`,this.editedItem,this.$toastr.success("Updated")),this.initialize()):t=u.post("/v1/bill",this.editedItem),t.then(o=>{this.editedIndex>-1?Object.assign(this.bills[this.editedIndex],o.data.data,this.$toastr.success(" created ")):this.bills.push(o.data.data)}).catch(o=>console.error("Saving error:",o)),this.close()},performSearch(){this.loading=!0;const t="/bill/search?query="+this.searchQuery;u.get(t).then(o=>{console.log("Search response:",o.data),this.bills=o.data,this.loading=!1}).catch(o=>{console.error("Search error:",o),this.loading=!1})}}},j={class:"text-h5"};function R(t,o,K,Q,F,s){const r=i("v-text-field"),_=i("v-container"),f=i("vCard"),g=i("v-toolbar-title"),k=i("v-divider"),c=i("v-spacer"),n=i("v-btn"),h=i("v-card-title"),m=i("v-col"),y=i("v-row"),C=i("v-card-text"),b=i("v-card-actions"),p=i("v-card"),v=i("v-dialog"),V=i("v-toolbar"),I=i("v-icon"),x=i("v-data-table"),U=i("AppLayout");return B(),D(U,null,{default:l(()=>[e(f,{class:"my-card"},{default:l(()=>[e(_,null,{default:l(()=>[e(r,{modelValue:t.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=a=>t.searchQuery=a),label:"Search",onKeyup:O(s.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{class:"my-card",outlined:""},{default:l(()=>[e(x,{headers:t.headers,loading:t.loading,items:t.bills,"sort-by":[{key:"bill",order:"asc"}]},{top:l(()=>[e(V,{flat:""},{default:l(()=>[e(g,null,{default:l(()=>[d("Bills")]),_:1}),e(k,{class:"mx-4",inset:"",vertical:""}),e(c),e(v,{modelValue:t.dialog,"onUpdate:modelValue":o[5]||(o[5]=a=>t.dialog=a),"max-width":"500px"},{activator:l(({props:a})=>[e(n,S({color:"primary",dark:"",class:"mb-2"},a),{default:l(()=>[d(" New Bill ")]),_:2},1040)]),default:l(()=>[e(p,null,{default:l(()=>[e(h,null,{default:l(()=>[L("span",j,N(s.formTitle),1)]),_:1}),e(C,null,{default:l(()=>[e(_,null,{default:l(()=>[e(y,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(r,{modelValue:t.editedItem.bill,"onUpdate:modelValue":o[1]||(o[1]=a=>t.editedItem.bill=a),label:"Bill "},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(r,{modelValue:t.editedItem.unit_cost,"onUpdate:modelValue":o[2]||(o[2]=a=>t.editedItem.unit_cost=a),label:"Unit Cost"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(r,{modelValue:t.editedItem.number_of_units,"onUpdate:modelValue":o[3]||(o[3]=a=>t.editedItem.number_of_units=a),label:"Number Of Units"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:l(()=>[e(r,{modelValue:t.editedItem.amount,"onUpdate:modelValue":o[4]||(o[4]=a=>t.editedItem.amount=a),label:"Amount"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c),e(n,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:l(()=>[d(" Cancel ")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:l(()=>[d(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(v,{modelValue:t.dialogDelete,"onUpdate:modelValue":o[6]||(o[6]=a=>t.dialogDelete=a),"max-width":"500px"},{default:l(()=>[e(p,null,{default:l(()=>[e(h,{class:"text-h5"},{default:l(()=>[d("Are you sure you want to delete this item?")]),_:1}),e(b,null,{default:l(()=>[e(c),e(n,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:l(()=>[d("Cancel")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:l(()=>[d("OK")]),_:1},8,["onClick"]),e(c)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:a})=>[e(I,{size:"small",class:"me-2",onClick:w=>s.editItem(a)},{default:l(()=>[d(" mdi-pencil ")]),_:2},1032,["onClick"]),e(I,{size:"small",onClick:w=>s.deleteItem(a)},{default:l(()=>[d(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":l(()=>[e(n,{color:"primary",onClick:s.initialize},{default:l(()=>[d(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"])]),_:1})]),_:1})}const E=z(P,[["render",R],["__scopeId","data-v-c28b29b7"]]);export{E as default};
