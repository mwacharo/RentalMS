import{_ as B}from"./AppLayout-jx6QWEP9.js";import{h as r,i as o,o as D,c as U,w as l,b as e,j as S,f as d,m as L,a as O,t as z}from"./app-37DS2Gtf.js";import{_ as P}from"./_plugin-vue_export-helper-x3n3nnut.js";const j={components:{AppLayout:B},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Bill",align:"start",sortable:!1,key:"bill"},{title:"Amount",key:"amount"},{title:"Actions",key:"actions",sortable:!1}],bills:[],searchQuery:"",editedIndex:-1,editedItem:{bill:"",amount:""},defaultItem:{bill:"",amount:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Bill":"Edit Bill"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){r.get("/billList").then(a=>{console.log("Bills API Response:",a.data),this.bills=a.data}).catch(a=>{console.error("Bill API Error:",a)})},editItem(t){this.editedIndex=this.bills.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.bills.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/bill/${this.editedItem.id}`).then(()=>{this.bills.splice(this.editedIndex,1),this.$toastr.warning(" deleted"),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?(t=r.put(this.$toastr.success(" Updated")`/bill/${this.editedItem.id}`,this.editedItem),this.initialize()):(this.$toastr.success(" created "),t=r.post("/bill",this.editedItem)),t.then(a=>{this.editedIndex>-1?Object.assign(this.bills[this.editedIndex],a.data.data):this.bills.push(a.data.data),this.close()}).catch(a=>console.error("Saving error:",a)),this.close()},performSearch(){this.loading=!0;const t="/bill/search?query="+this.searchQuery;r.get(t).then(a=>{console.log("Search response:",a.data),this.bills=a.data,this.loading=!1}).catch(a=>{console.error("Search error:",a),this.loading=!1})}}},N={class:"text-h5"};function R(t,a,K,Q,F,s){const u=o("v-text-field"),m=o("v-container"),_=o("vCard"),g=o("v-toolbar-title"),k=o("v-divider"),c=o("v-spacer"),n=o("v-btn"),h=o("v-card-title"),f=o("v-col"),y=o("v-row"),C=o("v-card-text"),p=o("v-card-actions"),v=o("v-card"),b=o("v-dialog"),x=o("v-toolbar"),I=o("v-icon"),V=o("v-data-table"),w=o("AppLayout");return D(),U(w,null,{default:l(()=>[e(_,{class:"my-card"},{default:l(()=>[e(m,null,{default:l(()=>[e(u,{modelValue:t.searchQuery,"onUpdate:modelValue":a[0]||(a[0]=i=>t.searchQuery=i),label:"Search",onKeyup:S(s.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(_,{class:"my-card",outlined:""},{default:l(()=>[e(V,{headers:t.headers,loading:t.loading,items:t.bills,"sort-by":[{key:"bill",order:"asc"}]},{top:l(()=>[e(x,{flat:""},{default:l(()=>[e(g,null,{default:l(()=>[d("Bills")]),_:1}),e(k,{class:"mx-4",inset:"",vertical:""}),e(c),e(b,{modelValue:t.dialog,"onUpdate:modelValue":a[3]||(a[3]=i=>t.dialog=i),"max-width":"500px"},{activator:l(({props:i})=>[e(n,L({color:"primary",dark:"",class:"mb-2"},i),{default:l(()=>[d(" New Bill ")]),_:2},1040)]),default:l(()=>[e(v,null,{default:l(()=>[e(h,null,{default:l(()=>[O("span",N,z(s.formTitle),1)]),_:1}),e(C,null,{default:l(()=>[e(m,null,{default:l(()=>[e(y,null,{default:l(()=>[e(f,{cols:"12"},{default:l(()=>[e(u,{modelValue:t.editedItem.bill,"onUpdate:modelValue":a[1]||(a[1]=i=>t.editedItem.bill=i),label:"Bill "},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(u,{modelValue:t.editedItem.amount,"onUpdate:modelValue":a[2]||(a[2]=i=>t.editedItem.amount=i),label:"Amount"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:l(()=>[e(c),e(n,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:l(()=>[d(" Cancel ")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:l(()=>[d(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(b,{modelValue:t.dialogDelete,"onUpdate:modelValue":a[4]||(a[4]=i=>t.dialogDelete=i),"max-width":"500px"},{default:l(()=>[e(v,null,{default:l(()=>[e(h,{class:"text-h5"},{default:l(()=>[d("Are you sure you want to delete this item?")]),_:1}),e(p,null,{default:l(()=>[e(c),e(n,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:l(()=>[d("Cancel")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:l(()=>[d("OK")]),_:1},8,["onClick"]),e(c)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:i})=>[e(I,{size:"small",class:"me-2",onClick:A=>s.editItem(i)},{default:l(()=>[d(" mdi-pencil ")]),_:2},1032,["onClick"]),e(I,{size:"small",onClick:A=>s.deleteItem(i)},{default:l(()=>[d(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":l(()=>[e(n,{color:"primary",onClick:s.initialize},{default:l(()=>[d(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"])]),_:1})]),_:1})}const E=P(j,[["render",R],["__scopeId","data-v-e3da1992"]]);export{E as default};
