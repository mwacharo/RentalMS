import{_ as P}from"./AppLayout-9H5TDcGT.js";import{h as r,i as a,o as w,c as R,w as o,b as e,j as L,f as n,m as S,a as N,t as O}from"./app-RXBFpgqh.js";import{_ as j}from"./_plugin-vue_export-helper-x3n3nnut.js";const z={components:{AppLayout:P},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Unit Number",align:"start",sortable:!1,key:"unit_number"},{title:"Rent",key:"rent"},{title:"Deposit",key:"deposit"},{title:"Property ",key:"property.property_name"},{title:"Actions",key:"actions",sortable:!1}],unit_number:"",searchQuery:"",properties:[],rent:[],deposit:[],units:[],property_name:"",property_id:"",editedIndex:-1,editedItem:{unit_number:"",rent:"",deposit:""},defaultItem:{email:"",phone:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Unit":"Edit Unit"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize(),this.fetchProperties()},methods:{initialize(){r.get("/units").then(l=>{console.log("API Response:",l.data),this.units=l.data}).catch(l=>{console.error("API Error:",l)})},editItem(t){this.editedIndex=this.units.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.units.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/unit/${this.editedItem.id}`).then(()=>{this.units.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/unit/${this.editedItem.id}`,this.editedItem):t=r.post("/unit",this.editedItem),t.then(l=>{this.editedIndex>-1?Object.assign(this.units[this.editedIndex],l.data.data):this.units.push(l.data.data),this.close()}).catch(l=>console.error("Saving error:",l))},performSearch(){this.loading=!0;const t="/unit/search?query="+this.searchQuery;r.get(t).then(l=>{console.log("Search response:",l.data),this.units=l.data,this.loading=!1}).catch(l=>{console.error("Search error:",l),this.loading=!1})},fetchProperties(){r.get("properties").then(l=>{console.log("properties response:",l.data),this.properties=l.data}).catch(l=>{console.error("failed to load properties:",l)})}}},K={class:"text-h5"};function Q(t,l,B,F,T,d){const u=a("v-text-field"),p=a("v-container"),_=a("VCard"),y=a("v-toolbar-title"),b=a("v-divider"),c=a("v-spacer"),s=a("v-btn"),f=a("v-card-title"),m=a("v-col"),k=a("v-select"),V=a("v-row"),C=a("v-card-text"),h=a("v-card-actions"),v=a("v-card"),I=a("v-dialog"),U=a("v-toolbar"),g=a("v-icon"),x=a("v-data-table"),D=a("AppLayout");return w(),R(D,null,{default:o(()=>[e(_,{class:"my-card"},{default:o(()=>[e(p,null,{default:o(()=>[e(u,{modelValue:t.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=i=>t.searchQuery=i),label:"Search",onKeyup:L(d.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(_,{class:"my-card",outlined:""},{default:o(()=>[e(x,{headers:t.headers,loading:t.loading,items:t.units,"sort-by":[{key:"unit_number",order:"asc"}]},{top:o(()=>[e(U,{flat:""},{default:o(()=>[e(y,null,{default:o(()=>[n("Unit")]),_:1}),e(b,{class:"mx-4",inset:"",vertical:""}),e(c),e(I,{modelValue:t.dialog,"onUpdate:modelValue":l[5]||(l[5]=i=>t.dialog=i),"max-width":"700px"},{activator:o(({props:i})=>[e(s,S({color:"primary",dark:"",class:"mb-2"},i),{default:o(()=>[n(" New Unit ")]),_:2},1040)]),default:o(()=>[e(v,null,{default:o(()=>[e(f,null,{default:o(()=>[N("span",K,O(d.formTitle),1)]),_:1}),e(C,null,{default:o(()=>[e(p,null,{default:o(()=>[e(V,null,{default:o(()=>[e(m,{cols:"12"},{default:o(()=>[e(u,{modelValue:t.editedItem.unit_number,"onUpdate:modelValue":l[1]||(l[1]=i=>t.editedItem.unit_number=i),label:"Unit Number"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:o(()=>[e(u,{modelValue:t.editedItem.rent,"onUpdate:modelValue":l[2]||(l[2]=i=>t.editedItem.rent=i),label:"Rent"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:o(()=>[e(u,{modelValue:t.editedItem.deposit,"onUpdate:modelValue":l[3]||(l[3]=i=>t.editedItem.deposit=i),label:"Deposit"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:o(()=>[e(k,{modelValue:t.editedItem.property_id,"onUpdate:modelValue":l[4]||(l[4]=i=>t.editedItem.property_id=i),items:t.properties,"item-title":"property_name",label:"Property","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(h,null,{default:o(()=>[e(c),e(s,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:o(()=>[n(" Cancel ")]),_:1},8,["onClick"]),e(s,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:o(()=>[n(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:t.dialogDelete,"onUpdate:modelValue":l[6]||(l[6]=i=>t.dialogDelete=i),"max-width":"500px"},{default:o(()=>[e(v,null,{default:o(()=>[e(f,{class:"text-h5"},{default:o(()=>[n("Are you sure you want to delete this item?")]),_:1}),e(h,null,{default:o(()=>[e(c),e(s,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:o(()=>[n("Cancel")]),_:1},8,["onClick"]),e(s,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:o(()=>[n("OK")]),_:1},8,["onClick"]),e(c)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":o(({item:i})=>[e(g,{size:"small",class:"me-2",onClick:A=>d.editItem(i)},{default:o(()=>[n(" mdi-pencil ")]),_:2},1032,["onClick"]),e(g,{size:"small",onClick:A=>d.deleteItem(i)},{default:o(()=>[n(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[e(s,{color:"primary",onClick:d.initialize},{default:o(()=>[n(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"])]),_:1})]),_:1})}const H=j(z,[["render",Q],["__scopeId","data-v-a49ff874"]]);export{H as default};
