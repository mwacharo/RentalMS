import{_ as A}from"./AppLayout-DLV5K9WW.js";import{h as a,c as B,o as D,w as o,b as t,i as O,f as d,a as S,t as L,m as N,j as u}from"./app-Cdoi5j0A.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={components:{AppLayout:A},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Bill",align:"start",sortable:!1,key:"bill"},{title:"Unit Cost",key:"unit_cost"},{title:"Number of units",key:"number_of_units"},{title:"Amount",key:"amount"},{title:"Actions",key:"actions",sortable:!1}],bills:[],searchQuery:"",editedIndex:-1,editedItem:{bill:"",amount:"",unit_cost:"",number_of_units:""},defaultItem:{bill:"",amount:"",unit_cost:"",number_of_units:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Bill":"Edit Bill"}},watch:{dialog(l){l||this.close()},dialogDelete(l){l||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){u.get("/v1/billList").then(e=>{console.log("Bills API Response:",e.data),this.bills=e.data}).catch(e=>{console.error("Bill API Error:",e)})},editItem(l){this.editedIndex=this.bills.indexOf(l),this.editedItem=Object.assign({},l),this.dialog=!0},deleteItem(l){this.editedIndex=this.bills.indexOf(l),this.editedItem=Object.assign({},l),this.dialogDelete=!0},deleteItemConfirm(){u.delete(`/bill/${this.editedItem.id}`).then(()=>{this.bills.splice(this.editedIndex,1),this.$toastr.warning(" deleted"),this.closeDelete()}).catch(l=>console.error("Deletion error:",l))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let l;this.editedIndex>-1?(l=u.put(`/bill/${this.editedItem.id}`,this.editedItem,this.$toastr.success("Updated")),this.initialize()):l=u.post("/v1/bill",this.editedItem),l.then(e=>{this.editedIndex>-1?Object.assign(this.bills[this.editedIndex],e.data.data,this.$toastr.success(" created ")):this.bills.push(e.data.data)}).catch(e=>console.error("Saving error:",e)),this.close()},performSearch(){this.loading=!0;const l="/bill/search?query="+this.searchQuery;u.get(l).then(e=>{console.log("Search response:",e.data),this.bills=e.data,this.loading=!1}).catch(e=>{console.error("Search error:",e),this.loading=!1})}}},j={class:"text-h5"};function R(l,e,K,Q,F,s){const r=a("v-text-field"),_=a("v-container"),f=a("vCard"),g=a("v-toolbar-title"),k=a("v-divider"),m=a("v-spacer"),n=a("v-btn"),b=a("v-card-title"),c=a("v-col"),y=a("v-row"),C=a("v-card-text"),p=a("v-card-actions"),v=a("v-card"),h=a("v-dialog"),V=a("v-toolbar"),I=a("v-icon"),x=a("v-data-table"),U=a("AppLayout");return D(),B(U,null,{default:o(()=>[t(f,{class:"my-card"},{default:o(()=>[t(_,null,{default:o(()=>[t(r,{modelValue:l.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=i=>l.searchQuery=i),label:"Search",onKeyup:O(s.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(f,{class:"my-card",outlined:""},{default:o(()=>[t(x,{headers:l.headers,loading:l.loading,items:l.bills,"sort-by":[{key:"bill",order:"asc"}]},{top:o(()=>[t(V,{flat:""},{default:o(()=>[t(g,null,{default:o(()=>e[7]||(e[7]=[d("Bills")])),_:1}),t(k,{class:"mx-4",inset:"",vertical:""}),t(m),t(h,{modelValue:l.dialog,"onUpdate:modelValue":e[5]||(e[5]=i=>l.dialog=i),"max-width":"500px"},{activator:o(({props:i})=>[t(n,N({color:"primary",dark:"",class:"mb-2"},i),{default:o(()=>e[8]||(e[8]=[d(" New Bill ")])),_:2},1040)]),default:o(()=>[t(v,null,{default:o(()=>[t(b,null,{default:o(()=>[S("span",j,L(s.formTitle),1)]),_:1}),t(C,null,{default:o(()=>[t(_,null,{default:o(()=>[t(y,null,{default:o(()=>[t(c,{cols:"12"},{default:o(()=>[t(r,{modelValue:l.editedItem.bill,"onUpdate:modelValue":e[1]||(e[1]=i=>l.editedItem.bill=i),label:"Bill "},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:o(()=>[t(r,{modelValue:l.editedItem.unit_cost,"onUpdate:modelValue":e[2]||(e[2]=i=>l.editedItem.unit_cost=i),label:"Unit Cost"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:o(()=>[t(r,{modelValue:l.editedItem.number_of_units,"onUpdate:modelValue":e[3]||(e[3]=i=>l.editedItem.number_of_units=i),label:"Number Of Units"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12"},{default:o(()=>[t(r,{modelValue:l.editedItem.amount,"onUpdate:modelValue":e[4]||(e[4]=i=>l.editedItem.amount=i),label:"Amount"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(m),t(n,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:o(()=>e[9]||(e[9]=[d(" Cancel ")])),_:1},8,["onClick"]),t(n,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:o(()=>e[10]||(e[10]=[d(" Save ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(h,{modelValue:l.dialogDelete,"onUpdate:modelValue":e[6]||(e[6]=i=>l.dialogDelete=i),"max-width":"500px"},{default:o(()=>[t(v,null,{default:o(()=>[t(b,{class:"text-h5"},{default:o(()=>e[11]||(e[11]=[d("Are you sure you want to delete this item?")])),_:1}),t(p,null,{default:o(()=>[t(m),t(n,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:o(()=>e[12]||(e[12]=[d("Cancel")])),_:1},8,["onClick"]),t(n,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:o(()=>e[13]||(e[13]=[d("OK")])),_:1},8,["onClick"]),t(m)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":o(({item:i})=>[t(I,{size:"small",class:"me-2",onClick:w=>s.editItem(i)},{default:o(()=>e[14]||(e[14]=[d(" mdi-pencil ")])),_:2},1032,["onClick"]),t(I,{size:"small",onClick:w=>s.deleteItem(i)},{default:o(()=>e[15]||(e[15]=[d(" mdi-delete ")])),_:2},1032,["onClick"])]),"no-data":o(()=>[t(n,{color:"primary",onClick:s.initialize},{default:o(()=>e[16]||(e[16]=[d(" Reset ")])),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"])]),_:1})]),_:1})}const E=z(P,[["render",R],["__scopeId","data-v-c28b29b7"]]);export{E as default};
