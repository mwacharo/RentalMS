import{_ as M}from"./AppLayout-DLV5K9WW.js";import{h as o,d as K,o as Q,f as i,b as t,w as l,i as z,a as p,m as c,t as q,F as $,j as r}from"./app-Cdoi5j0A.js";import G from"./Bill-CVYBGFlL.js";import H from"./TenantInvoice-ivhneSsF.js";import J from"./Excel-CanLNy-y.js";import W from"./SMSTenant-DH1Iulc2.js";import X from"./EmailTenant-fIxtIa9N.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={components:{AppLayout:M,bill:G,tenantinvoice:H,excel:J,smstenant:W,emailtenant:X},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Tenant Name",align:"start",sortable:!1,key:"tenant_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Property ",key:"property.property_name"},{title:"Actions",key:"actions",sortable:!1}],selected:[],invoiceData:null,landlords:[],searchQuery:"",properties:[],tenants:[],tenant_name:[],property_id:[],units:[],bills:[],unit_id:"",editedIndex:-1,editedItem:{landlord_name:"",email:"",phone:""},defaultItem:{landlord_name:"",email:"",phone:"",tenant_name:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Tenant":"Edit Tenant"}},watch:{dialog(n){n||this.close()},dialogDelete(n){n||this.closeDelete()}},created(){this.initialize(),this.fetchProperties(),this.fetchUnits()},methods:{initialize(){r.get("/tenants").then(e=>{console.log("API Response:",e.data),this.tenants=e.data}).catch(e=>{console.error("API Error:",e)})},openBill(n){this.$refs.bill.show(n)},openTenantInvoice(n){const e="tenantBills/"+n.id;r.post(e).then(f=>{this.bills=f.data}).catch(f=>{console.error("Error creating invoice:",f)}),this.$refs.tenantinvoice.show(n)},openExcel(n){this.$refs.excel.show(n)},openSMS(n){this.$refs.SMSTenantComponent.show(n)},openEmail(n){this.$refs.EmailTenantComponent.show(n)},editItem(n){this.editedIndex=this.tenants.indexOf(n),this.editedItem=Object.assign({},n),this.dialog=!0},deleteItem(n){this.editedIndex=this.tenants.indexOf(n),this.editedItem=Object.assign({},n),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/tenant/${this.editedItem.id}`).then(()=>{this.tenants.splice(this.editedIndex,1),this.closeDelete()}).catch(n=>console.error("Deletion error:",n))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let n;this.editedIndex>-1?n=r.put(`/tenant/${this.editedItem.id}`,this.editedItem):n=r.post("/tenant",this.editedItem),n.then(e=>{this.editedIndex>-1?Object.assign(this.tenants[this.editedIndex],e.data.data):this.tenants.push(e.data.data),this.close()}).catch(e=>console.error("Saving error:",e))},performSearch(){this.loading=!0;const n="/landlords/search?query="+this.searchQuery;r.get(n).then(e=>{console.log("Search response:",e.data),this.tenants=e.data,this.loading=!1}).catch(e=>{console.error("Search error:",e),this.loading=!1})},fetchUnits(){r.get("units").then(e=>{console.log("units response:",e.data),this.units=e.data}).catch(e=>{console.error("failed to load units:",e)})},fetchProperties(){r.get("properties").then(e=>{console.log("properties response:",e.data),this.properties=e.data}).catch(e=>{console.error("failed to load properties:",e)})}}},ee={class:"text-h5"};function te(n,e,f,ne,le,d){const _=o("v-text-field"),g=o("v-container"),k=o("VCard"),S=o("v-toolbar-title"),U=o("v-divider"),v=o("v-spacer"),s=o("v-btn"),y=o("v-card-title"),u=o("v-col"),C=o("v-select"),w=o("v-file-input"),A=o("v-row"),P=o("v-card-text"),V=o("v-card-actions"),T=o("V-card"),x=o("v-dialog"),D=o("v-card"),E=o("v-toolbar"),h=o("v-icon"),I=o("v-tooltip"),L=o("v-data-table"),R=o("bill"),N=o("tenantinvoice"),B=o("excel"),O=o("smstenant"),j=o("emailtenant"),F=o("AppLayout");return Q(),K($,null,[e[27]||(e[27]=i(", ")),t(F,null,{default:l(()=>[t(k,{class:"my-card"},{default:l(()=>[t(g,null,{default:l(()=>[t(_,{modelValue:n.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=a=>n.searchQuery=a),label:"Search",onKeyup:z(d.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(k,{class:"my-card",outlined:""},{default:l(()=>[t(L,{"show-select":"",headers:n.headers,loading:n.loading,items:n.tenants,"sort-by":[{key:"tenant_name",order:"asc"}]},{top:l(()=>[t(E,null,{default:l(()=>[t(S,null,{default:l(()=>e[8]||(e[8]=[i("Tenant")])),_:1}),t(U,{class:"mx-4",inset:"",vertical:""}),t(v),t(x,{modelValue:n.dialog,"onUpdate:modelValue":e[6]||(e[6]=a=>n.dialog=a),"max-width":"700px"},{activator:l(({props:a})=>[t(s,{color:"success",dark:"",class:"mb-2 mr-2",onClick:d.openExcel,"prepend-icon":"mdi-file-excel",variant:"outlined"},{default:l(()=>e[9]||(e[9]=[i(" Import ")])),_:1},8,["onClick"]),t(s,{color:"primary",dark:"",class:"mb-2",onClick:d.openSMS,"prepend-icon":"mdi-send",variant:"outlined"},{default:l(()=>e[10]||(e[10]=[i(" SMS ")])),_:1},8,["onClick"]),t(s,{color:"primary",dark:"",class:"mb-2",onClick:d.openEmail,"prepend-icon":"mdi-email"},{default:l(()=>e[11]||(e[11]=[i(" Email ")])),_:1},8,["onClick"]),t(s,c({color:"primary",dark:"",class:"mb-2"},a,{"prepend-icon":"mdi-plus",variant:"outlined"}),{default:l(()=>e[12]||(e[12]=[i(" Tenant ")])),_:2},1040)]),default:l(()=>[t(T,null,{default:l(()=>[t(y,null,{default:l(()=>[p("span",ee,q(d.formTitle),1)]),_:1}),t(P,null,{default:l(()=>[t(g,null,{default:l(()=>[t(A,null,{default:l(()=>[t(u,{cols:"12",sm:"6"},{default:l(()=>[t(_,{modelValue:n.editedItem.tenant_name,"onUpdate:modelValue":e[1]||(e[1]=a=>n.editedItem.tenant_name=a),label:"Tanant Name"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:l(()=>[t(_,{modelValue:n.editedItem.email,"onUpdate:modelValue":e[2]||(e[2]=a=>n.editedItem.email=a),label:"Email"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:l(()=>[t(_,{modelValue:n.editedItem.phone,"onUpdate:modelValue":e[3]||(e[3]=a=>n.editedItem.phone=a),label:"phone"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:l(()=>[t(C,{modelValue:n.editedItem.property_id,"onUpdate:modelValue":e[4]||(e[4]=a=>n.editedItem.property_id=a),items:n.properties,"item-title":"property_name",label:"Property Name","item-value":"id"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:l(()=>[t(C,{modelValue:n.editedItem.unit_id,"onUpdate:modelValue":e[5]||(e[5]=a=>n.editedItem.unit_id=a),items:n.units,"item-title":"unit_number",label:"Unit Number","item-value":"id"},null,8,["modelValue","items"])]),_:1}),t(w,{label:"Select  file",accept:"pfd",onChange:n.uploadaAgreement},null,8,["onChange"])]),_:1})]),_:1})]),_:1}),t(V,null,{default:l(()=>[t(v),t(s,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:l(()=>e[13]||(e[13]=[i(" Cancel ")])),_:1},8,["onClick"]),t(s,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:l(()=>e[14]||(e[14]=[i(" Save ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(x,{modelValue:n.dialogDelete,"onUpdate:modelValue":e[7]||(e[7]=a=>n.dialogDelete=a),"max-width":"500px"},{default:l(()=>[t(D,null,{default:l(()=>[t(y,{class:"text-h5"},{default:l(()=>e[15]||(e[15]=[i("Are you sure you want to delete this item?")])),_:1}),t(V,null,{default:l(()=>[t(v),t(s,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:l(()=>e[16]||(e[16]=[i("Cancel")])),_:1},8,["onClick"]),t(s,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:l(()=>e[17]||(e[17]=[i("OK")])),_:1},8,["onClick"]),t(v)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:a})=>[t(I,{location:"bottom"},{activator:l(({props:m})=>[t(s,c({icon:""},m,{onClick:b=>d.openTenantInvoice(a),variant:"text"}),{default:l(()=>[t(h,{color:"primary"},{default:l(()=>e[18]||(e[18]=[i(" mdi-eye ")])),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[e[19]||(e[19]=p("span",null,"Invoice details",-1))]),_:2},1024),t(I,{location:"bottom"},{activator:l(({props:m})=>[t(s,c({icon:""},m,{onClick:b=>d.editItem(a),variant:"text"}),{default:l(()=>[t(h,{color:"info"},{default:l(()=>e[20]||(e[20]=[i(" mdi-pencil ")])),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[e[21]||(e[21]=p("span",null,"Edit",-1))]),_:2},1024),t(I,{location:"bottom"},{activator:l(({props:m})=>[t(s,c({icon:""},m,{onClick:b=>d.openBill(a),variant:"text"}),{default:l(()=>[t(h,{color:"warning"},{default:l(()=>e[22]||(e[22]=[i(" mdi-cog ")])),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[e[23]||(e[23]=p("span",null,"Assign Bills",-1))]),_:2},1024),t(I,{location:"bottom"},{activator:l(({props:m})=>[t(s,c({icon:""},m,{onClick:b=>d.deleteItem(a),variant:"text"}),{default:l(()=>[t(h,{color:"error"},{default:l(()=>e[24]||(e[24]=[i(" mdi-delete ")])),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[e[25]||(e[25]=p("span",null,"Delete",-1))]),_:2},1024)]),"no-data":l(()=>[t(s,{color:"primary",onClick:d.initialize},{default:l(()=>e[26]||(e[26]=[i(" Reset ")])),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),t(R,{ref:"bill"},null,512),t(N,{bills:n.bills,ref:"tenantinvoice"},null,8,["bills"]),t(B,{ref:"excel"},null,512),t(O,{ref:"SMSTenantComponent"},null,512),t(j,{ref:"EmailTenantComponent"},null,512)]),_:1})]),_:1})],64)}const pe=Y(Z,[["render",te],["__scopeId","data-v-54d16b9d"]]);export{pe as default};
