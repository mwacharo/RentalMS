import{_ as K}from"./AppLayout-NFg5W1Oh.js";import{h as r,i as l,o as Q,d as q,f as i,b as e,w as n,F as z,j as $,m as u,a as p,t as G,p as H,q as J}from"./app-qJPxjpWE.js";import W from"./Bill-ARzgYrBA.js";import X from"./TenantInvoice-uVPu6Seo.js";import Y from"./Excel-xtAmDZ7w.js";import Z from"./SMSTenant-Ie3klkky.js";import ee from"./EmailTenant-m-G0LcJe.js";import{_ as te}from"./_plugin-vue_export-helper-x3n3nnut.js";const ne={components:{AppLayout:K,bill:W,tenantinvoice:X,excel:Y,smstenant:Z,emailtenant:ee},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Tenant Name",align:"start",sortable:!1,key:"tenant_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Property ",key:"property.property_name"},{title:"Actions",key:"actions",sortable:!1}],selected:[],invoiceData:null,landlords:[],searchQuery:"",properties:[],tenants:[],tenant_name:[],property_id:[],units:[],bills:[],unit_id:"",editedIndex:-1,editedItem:{landlord_name:"",email:"",phone:""},defaultItem:{landlord_name:"",email:"",phone:"",tenant_name:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Tenant":"Edit Tenant"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize(),this.fetchProperties(),this.fetchUnits()},methods:{initialize(){r.get("/tenants").then(o=>{console.log("API Response:",o.data),this.tenants=o.data}).catch(o=>{console.error("API Error:",o)})},openBill(t){this.$refs.bill.show(t)},openTenantInvoice(t){const o="tenantBills/"+t.id;r.post(o).then(_=>{this.bills=_.data}).catch(_=>{console.error("Error creating invoice:",_)}),this.$refs.tenantinvoice.show(t)},openExcel(t){this.$refs.excel.show(t)},openSMS(t){this.$refs.SMSTenantComponent.show(t)},openEmail(t){this.$refs.EmailTenantComponent.show(t)},editItem(t){this.editedIndex=this.tenants.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.tenants.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/tenant/${this.editedItem.id}`).then(()=>{this.tenants.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/tenant/${this.editedItem.id}`,this.editedItem):t=r.post("/tenant",this.editedItem),t.then(o=>{this.editedIndex>-1?Object.assign(this.tenants[this.editedIndex],o.data.data):this.tenants.push(o.data.data),this.close()}).catch(o=>console.error("Saving error:",o))},performSearch(){this.loading=!0;const t="/landlords/search?query="+this.searchQuery;r.get(t).then(o=>{console.log("Search response:",o.data),this.tenants=o.data,this.loading=!1}).catch(o=>{console.error("Search error:",o),this.loading=!1})},fetchUnits(){r.get("units").then(o=>{console.log("units response:",o.data),this.units=o.data}).catch(o=>{console.error("failed to load units:",o)})},fetchProperties(){r.get("properties").then(o=>{console.log("properties response:",o.data),this.properties=o.data}).catch(o=>{console.error("failed to load properties:",o)})}}},b=t=>(H("data-v-09ab0839"),t=t(),J(),t),oe={class:"text-h5"},le=b(()=>p("span",null,"Invoice details",-1)),ae=b(()=>p("span",null,"Edit",-1)),ie=b(()=>p("span",null,"Assign Bills",-1)),de=b(()=>p("span",null,"Delete",-1));function se(t,o,_,re,ce,d){const f=l("v-text-field"),k=l("v-container"),y=l("VCard"),w=l("v-toolbar-title"),A=l("v-divider"),h=l("v-spacer"),s=l("v-btn"),C=l("v-card-title"),m=l("v-col"),V=l("v-select"),U=l("v-file-input"),P=l("v-row"),T=l("v-card-text"),S=l("v-card-actions"),D=l("V-card"),x=l("v-dialog"),E=l("v-card"),L=l("v-toolbar"),v=l("v-icon"),I=l("v-tooltip"),R=l("v-data-table"),N=l("bill"),B=l("tenantinvoice"),O=l("excel"),j=l("smstenant"),F=l("emailtenant"),M=l("AppLayout");return Q(),q(z,null,[i(", "),e(M,null,{default:n(()=>[e(y,{class:"my-card"},{default:n(()=>[e(k,null,{default:n(()=>[e(f,{modelValue:t.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=a=>t.searchQuery=a),label:"Search",onKeyup:$(d.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(y,{class:"my-card",outlined:""},{default:n(()=>[e(R,{"show-select":"",headers:t.headers,loading:t.loading,items:t.tenants,"sort-by":[{key:"tenant_name",order:"asc"}]},{top:n(()=>[e(L,null,{default:n(()=>[e(w,null,{default:n(()=>[i("Tenant")]),_:1}),e(A,{class:"mx-4",inset:"",vertical:""}),e(h),e(x,{modelValue:t.dialog,"onUpdate:modelValue":o[6]||(o[6]=a=>t.dialog=a),"max-width":"700px"},{activator:n(({props:a})=>[e(s,{color:"success",dark:"",class:"mb-2 mr-2",onClick:d.openExcel,"prepend-icon":"mdi-file-excel",variant:"outlined"},{default:n(()=>[i(" Import ")]),_:1},8,["onClick"]),e(s,{color:"primary",dark:"",class:"mb-2",onClick:d.openSMS,"prepend-icon":"mdi-send",variant:"outlined"},{default:n(()=>[i(" SMS ")]),_:1},8,["onClick"]),e(s,{color:"primary",dark:"",class:"mb-2",onClick:d.openEmail,"prepend-icon":"mdi-email"},{default:n(()=>[i(" Email ")]),_:1},8,["onClick"]),e(s,u({color:"primary",dark:"",class:"mb-2"},a,{"prepend-icon":"mdi-plus",variant:"outlined"}),{default:n(()=>[i(" Tenant ")]),_:2},1040)]),default:n(()=>[e(D,null,{default:n(()=>[e(C,null,{default:n(()=>[p("span",oe,G(d.formTitle),1)]),_:1}),e(T,null,{default:n(()=>[e(k,null,{default:n(()=>[e(P,null,{default:n(()=>[e(m,{cols:"12",sm:"6"},{default:n(()=>[e(f,{modelValue:t.editedItem.tenant_name,"onUpdate:modelValue":o[1]||(o[1]=a=>t.editedItem.tenant_name=a),label:"Tanant Name"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:n(()=>[e(f,{modelValue:t.editedItem.email,"onUpdate:modelValue":o[2]||(o[2]=a=>t.editedItem.email=a),label:"Email"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:n(()=>[e(f,{modelValue:t.editedItem.phone,"onUpdate:modelValue":o[3]||(o[3]=a=>t.editedItem.phone=a),label:"phone"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:n(()=>[e(V,{modelValue:t.editedItem.property_id,"onUpdate:modelValue":o[4]||(o[4]=a=>t.editedItem.property_id=a),items:t.properties,"item-title":"property_name",label:"Property Name","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:n(()=>[e(V,{modelValue:t.editedItem.unit_id,"onUpdate:modelValue":o[5]||(o[5]=a=>t.editedItem.unit_id=a),items:t.units,"item-title":"unit_number",label:"Account Number","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(U,{label:"Select  file",accept:"pfd",onChange:t.uploadaAgreement},null,8,["onChange"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:n(()=>[e(h),e(s,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:n(()=>[i(" Cancel ")]),_:1},8,["onClick"]),e(s,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:n(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(x,{modelValue:t.dialogDelete,"onUpdate:modelValue":o[7]||(o[7]=a=>t.dialogDelete=a),"max-width":"500px"},{default:n(()=>[e(E,null,{default:n(()=>[e(C,{class:"text-h5"},{default:n(()=>[i("Are you sure you want to delete this item?")]),_:1}),e(S,null,{default:n(()=>[e(h),e(s,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:n(()=>[i("Cancel")]),_:1},8,["onClick"]),e(s,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:n(()=>[i("OK")]),_:1},8,["onClick"]),e(h)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":n(({item:a})=>[e(I,{location:"bottom"},{activator:n(({props:c})=>[e(s,u({icon:""},c,{onClick:g=>d.openTenantInvoice(a),variant:"text"}),{default:n(()=>[e(v,{color:"primary"},{default:n(()=>[i(" mdi-eye ")]),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[le]),_:2},1024),e(I,{location:"bottom"},{activator:n(({props:c})=>[e(s,u({icon:""},c,{onClick:g=>d.editItem(a),variant:"text"}),{default:n(()=>[e(v,{color:"info"},{default:n(()=>[i(" mdi-pencil ")]),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[ae]),_:2},1024),e(I,{location:"bottom"},{activator:n(({props:c})=>[e(s,u({icon:""},c,{onClick:g=>d.openBill(a),variant:"text"}),{default:n(()=>[e(v,{color:"warning"},{default:n(()=>[i(" mdi-cog ")]),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[ie]),_:2},1024),e(I,{location:"bottom"},{activator:n(({props:c})=>[e(s,u({icon:""},c,{onClick:g=>d.deleteItem(a),variant:"text"}),{default:n(()=>[e(v,{color:"error"},{default:n(()=>[i(" mdi-delete ")]),_:1})]),_:2},1040,["onClick"])]),default:n(()=>[de]),_:2},1024)]),"no-data":n(()=>[e(s,{color:"primary",onClick:d.initialize},{default:n(()=>[i(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(N,{ref:"bill"},null,512),e(B,{bills:t.bills,ref:"tenantinvoice"},null,8,["bills"]),e(O,{ref:"excel"},null,512),e(j,{ref:"SMSTenantComponent"},null,512),e(F,{ref:"EmailTenantComponent"},null,512)]),_:1})]),_:1})],64)}const be=te(ne,[["render",se],["__scopeId","data-v-09ab0839"]]);export{be as default};
