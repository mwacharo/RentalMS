import{_ as U}from"./AppLayout-ieo5Sf3A.js";import{h as r,i as a,o as w,c as S,w as l,b as e,j as N,f as i,m as O,a as z,t as L}from"./app-4ka3Qwr3.js";import j from"./Permissions-xp4Qjfu_.js";import{_ as R}from"./_plugin-vue_export-helper-x3n3nnut.js";const E={components:{AppLayout:U,Permissions:j},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Agent Name",align:"start",sortable:!1,key:"name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Actions",key:"actions",sortable:!1}],users:[],searchQuery:"",editedIndex:-1,editedItem:{name:"",email:"",phone:""},defaultItem:{name:"",email:"",phone:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Admin":"Edit Admin"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){r.get("/users").then(o=>{console.log("API Response:",o.data),this.users=o.data}).catch(o=>{console.error("API Error:",o)})},openUserPermissions(t){this.$refs.UserPermissions.showDialog(t.id)},editItem(t){this.editedIndex=this.users.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.users.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/user/${this.editedItem.id}`).then(()=>{this.users.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/user/${this.editedItem.id}`,this.editedItem):t=r.post("/user",this.editedItem),t.then(o=>{this.editedIndex>-1?Object.assign(this.users[this.editedIndex],o.data.data):this.users.push(o.data.data),this.close()}).catch(o=>console.error("Saving error:",o)),this.close()},performSearch(){this.loading=!0;const t="/users/search?query="+this.searchQuery;r.get(t).then(o=>{console.log("Search response:",o.data),this.users=o.data,this.loading=!1}).catch(o=>{console.error("Search error:",o),this.loading=!1})}}},K={class:"text-h5"};function Q(t,o,B,F,T,d){const c=a("v-text-field"),h=a("v-container"),f=a("VCard"),b=a("v-toolbar-title"),y=a("v-divider"),m=a("v-spacer"),n=a("v-btn"),p=a("v-card-title"),u=a("v-col"),C=a("v-row"),V=a("v-card-text"),v=a("v-card-actions"),I=a("v-card"),g=a("v-dialog"),x=a("v-toolbar"),_=a("v-icon"),A=a("v-data-table"),P=a("Permissions"),D=a("AppLayout");return w(),S(D,null,{default:l(()=>[e(f,{class:"my-card"},{default:l(()=>[e(h,null,{default:l(()=>[e(c,{modelValue:t.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=s=>t.searchQuery=s),label:"Search",onKeyup:N(d.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{class:"my-card",outlined:""},{default:l(()=>[e(A,{headers:t.headers,loading:t.loading,items:t.users,"sort-by":[{key:"name",order:"asc"}]},{top:l(()=>[e(x,{flat:""},{default:l(()=>[e(b,null,{default:l(()=>[i("Admin")]),_:1}),e(y,{class:"mx-4",inset:"",vertical:""}),e(m),e(g,{modelValue:t.dialog,"onUpdate:modelValue":o[4]||(o[4]=s=>t.dialog=s),"max-width":"500px"},{activator:l(({props:s})=>[e(n,O({color:"primary",dark:"",class:"mb-2"},s),{default:l(()=>[i(" New Admin ")]),_:2},1040)]),default:l(()=>[e(I,null,{default:l(()=>[e(p,null,{default:l(()=>[z("span",K,L(d.formTitle),1)]),_:1}),e(V,null,{default:l(()=>[e(h,null,{default:l(()=>[e(C,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(c,{modelValue:t.editedItem.name,"onUpdate:modelValue":o[1]||(o[1]=s=>t.editedItem.name=s),label:" Name"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(c,{modelValue:t.editedItem.email,"onUpdate:modelValue":o[2]||(o[2]=s=>t.editedItem.email=s),label:"Email"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(c,{modelValue:t.editedItem.phone,"onUpdate:modelValue":o[3]||(o[3]=s=>t.editedItem.phone=s),label:"phone"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(m),e(n,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:l(()=>[i(" Cancel ")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:l(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(g,{modelValue:t.dialogDelete,"onUpdate:modelValue":o[5]||(o[5]=s=>t.dialogDelete=s),"max-width":"500px"},{default:l(()=>[e(I,null,{default:l(()=>[e(p,{class:"text-h5"},{default:l(()=>[i("Are you sure you want to delete this item?")]),_:1}),e(v,null,{default:l(()=>[e(m),e(n,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:l(()=>[i("Cancel")]),_:1},8,["onClick"]),e(n,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:l(()=>[i("OK")]),_:1},8,["onClick"]),e(m)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":l(({item:s})=>[e(_,{size:"small",color:"info",class:"me-2",onClick:k=>d.editItem(s)},{default:l(()=>[i(" mdi-pencil ")]),_:2},1032,["onClick"]),e(_,{size:"small",color:"success",class:"me-2",onClick:k=>d.openUserPermissions(s)},{default:l(()=>[i(" mdi-lock ")]),_:2},1032,["onClick"]),e(_,{size:"small",color:"error",onClick:k=>d.deleteItem(s)},{default:l(()=>[i(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":l(()=>[e(n,{color:"primary",onClick:d.initialize},{default:l(()=>[i(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(P,{ref:"UserPermissions"},null,512)]),_:1})]),_:1})}const J=R(E,[["render",Q],["__scopeId","data-v-67c24807"]]);export{J as default};
