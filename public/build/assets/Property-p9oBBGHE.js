import{_ as L}from"./AppLayout-_3W4pAjT.js";import{h as u,i as a,o as N,c as x,w as o,b as e,j as S,f as i,m as O,a as R,t as z}from"./app-7hMa5QvB.js";import j from"./PropertyUnit-Hd9gVk1_.js";import{_ as E}from"./_plugin-vue_export-helper-x3n3nnut.js";const K={components:{AppLayout:L,PropertyUnit:j},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Property Name",align:"start",sortable:!1,key:"property_name"},{title:"Address",key:"address"},{title:"Email",key:"email"},{title:"Phone Number",key:"phone"},{title:"Description",key:"description"},{title:"Landlord",key:"landlord.landlord_name"},{title:"Units",key:"number_of_units"},{title:"Actions",key:"actions",sortable:!1}],properties:[],landlords:[],editedIndex:-1,searchQuery:"",editedItem:{property_name:"",email:"",phone:"",description:"",number_of_units:"",address:""},defaultItem:{property_name:"",email:"",phone:"",landlord_id:"",number_of_units:"",description:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Property":"Edit Property"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize(),this.fetchlandlord()},methods:{viewUnits(t){this.$refs.PropertyUnit.show(t)},initialize(){u.get("/properties").then(l=>{console.log("API Response:",l.data),this.properties=l.data}).catch(l=>{console.error("API Error:",l)})},editItem(t){this.editedIndex=this.properties.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.properties.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){u.delete(`/property/${this.editedItem.id}`).then(()=>{this.properties.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=u.put(`/property/${this.editedItem.id}`,this.editedItem):t=u.post("/property",this.editedItem),t.then(l=>{this.editedIndex>-1?Object.assign(this.properties[this.editedIndex],l.data.data):this.properties.push(l.data.data),this.close()}).catch(l=>console.error("Saving error:",l))},performSearch(){this.loading=!0;const t="/property/search?query="+this.searchQuery;u.get(t).then(l=>{console.log("Search response:",l.data),this.properties=l.data,this.loading=!1}).catch(l=>{console.error("Search error:",l),this.loading=!1})},fetchlandlord(){u.get("/landlords").then(l=>{console.log("Landlords response:",l.data),this.landlords=l.data}).catch(l=>{console.error("failed to load landlords:",l)})}}},Q={class:"text-h5"};function B(t,l,F,T,q,n){const r=a("v-text-field"),_=a("v-container"),f=a("VCard"),g=a("v-toolbar-title"),V=a("v-divider"),p=a("v-spacer"),m=a("v-btn"),h=a("v-card-title"),s=a("v-col"),k=a("v-select"),C=a("v-row"),U=a("v-card-text"),v=a("v-card-actions"),y=a("v-card"),I=a("v-dialog"),P=a("v-toolbar"),c=a("v-icon"),w=a("v-data-table"),A=a("PropertyUnit"),D=a("AppLayout");return N(),x(D,null,{default:o(()=>[e(f,{class:"my-card"},{default:o(()=>[e(_,null,{default:o(()=>[e(r,{modelValue:t.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=d=>t.searchQuery=d),label:"Search",onKeyup:S(n.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(f,{class:"my-card",outlined:""},{default:o(()=>[e(w,{headers:t.headers,loading:t.loading,items:t.properties,"sort-by":[{key:"property_name",order:"asc"}]},{top:o(()=>[e(P,{flat:""},{default:o(()=>[e(g,null,{default:o(()=>[i("Property")]),_:1}),e(V,{class:"mx-4",inset:"",vertical:""}),e(p),e(I,{modelValue:t.dialog,"onUpdate:modelValue":l[8]||(l[8]=d=>t.dialog=d),"max-width":"500px"},{activator:o(({props:d})=>[e(m,O({color:"primary",dark:"",class:"mb-2"},d),{default:o(()=>[i(" New Property ")]),_:2},1040)]),default:o(()=>[e(y,null,{default:o(()=>[e(h,null,{default:o(()=>[R("span",Q,z(n.formTitle),1)]),_:1}),e(U,null,{default:o(()=>[e(_,null,{default:o(()=>[e(C,null,{default:o(()=>[e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.property_name,"onUpdate:modelValue":l[1]||(l[1]=d=>t.editedItem.property_name=d),label:"Property Name"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.email,"onUpdate:modelValue":l[2]||(l[2]=d=>t.editedItem.email=d),label:"Email"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.phone,"onUpdate:modelValue":l[3]||(l[3]=d=>t.editedItem.phone=d),label:"phone"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.address,"onUpdate:modelValue":l[4]||(l[4]=d=>t.editedItem.address=d),label:"Address"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.description,"onUpdate:modelValue":l[5]||(l[5]=d=>t.editedItem.description=d),label:"Description"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(r,{modelValue:t.editedItem.number_of_units,"onUpdate:modelValue":l[6]||(l[6]=d=>t.editedItem.number_of_units=d),label:"Units"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(k,{modelValue:t.editedItem.landlord_id,"onUpdate:modelValue":l[7]||(l[7]=d=>t.editedItem.landlord_id=d),items:t.landlords,"item-title":"landlord_name",label:"Landlord Name","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(v,null,{default:o(()=>[e(p),e(m,{color:"blue-darken-1",variant:"text",onClick:n.close},{default:o(()=>[i(" Cancel ")]),_:1},8,["onClick"]),e(m,{color:"blue-darken-1",variant:"text",onClick:n.save},{default:o(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:t.dialogDelete,"onUpdate:modelValue":l[9]||(l[9]=d=>t.dialogDelete=d),"max-width":"500px"},{default:o(()=>[e(y,null,{default:o(()=>[e(h,{class:"text-h5"},{default:o(()=>[i("Are you sure you want to delete this item?")]),_:1}),e(v,null,{default:o(()=>[e(p),e(m,{color:"blue-darken-1",variant:"text",onClick:n.closeDelete},{default:o(()=>[i("Cancel")]),_:1},8,["onClick"]),e(m,{color:"blue-darken-1",variant:"text",onClick:n.deleteItemConfirm},{default:o(()=>[i("OK")]),_:1},8,["onClick"]),e(p)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":o(({item:d})=>[e(c,{size:"small",class:"me-2",onClick:b=>n.editItem(d)},{default:o(()=>[i(" mdi-pencil ")]),_:2},1032,["onClick"]),e(c,{size:"small",class:"me-2",onClick:b=>n.viewUnits(d)},{default:o(()=>[i(" mdi-home-outline ")]),_:2},1032,["onClick"]),e(c,{size:"small",onClick:b=>n.deleteItem(d)},{default:o(()=>[i(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[e(m,{color:"primary",onClick:n.initialize},{default:o(()=>[i(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(A,{ref:"PropertyUnit"},null,512)]),_:1})]),_:1})}const M=E(K,[["render",B],["__scopeId","data-v-2b7fe428"]]);export{M as default};
