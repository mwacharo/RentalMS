import{_ as A}from"./AppLayout-jx6QWEP9.js";import{h as r,i as o,o as U,c as S,w as a,b as e,j as N,f as d,m as O,a as P,t as L}from"./app-37DS2Gtf.js";import{_ as j}from"./_plugin-vue_export-helper-x3n3nnut.js";const z={components:{AppLayout:A},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Agent Name",align:"start",sortable:!1,key:"company_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Actions",key:"actions",sortable:!1}],users:[],searchQuery:"",editedIndex:-1,editedItem:{company_name:"",email:"",phone:""},defaultItem:{company_name:"",email:"",phone:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Company":"Edit Company"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){r.get("/companies").then(l=>{console.log("API Response:",l.data),this.users=l.data}).catch(l=>{console.error("API Error:",l)})},editItem(t){this.editedIndex=this.users.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.users.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/company/${this.editedItem.id}`).then(()=>{this.users.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/company/${this.editedItem.id}`,this.editedItem):t=r.post("/company",this.editedItem),t.then(l=>{this.editedIndex>-1?Object.assign(this.users[this.editedIndex],l.data.data):this.users.push(l.data.data),this.close()}).catch(l=>console.error("Saving error:",l)),this.close()},performSearch(){this.loading=!0;const t="/company/search?query="+this.searchQuery;r.get(t).then(l=>{console.log("Search response:",l.data),this.users=l.data,this.loading=!1}).catch(l=>{console.error("Search error:",l),this.loading=!1})}}},R={class:"text-h5"};function E(t,l,K,Q,B,s){const c=o("v-text-field"),_=o("v-container"),p=o("VCard"),g=o("v-toolbar-title"),C=o("v-divider"),m=o("v-spacer"),i=o("v-btn"),h=o("v-card-title"),u=o("v-col"),b=o("v-row"),k=o("v-card-text"),f=o("v-card-actions"),v=o("v-card"),y=o("v-dialog"),V=o("v-toolbar"),I=o("v-icon"),x=o("v-data-table"),D=o("AppLayout");return U(),S(D,null,{default:a(()=>[e(p,{class:"my-card"},{default:a(()=>[e(_,null,{default:a(()=>[e(c,{modelValue:t.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=n=>t.searchQuery=n),label:"Search",onKeyup:N(s.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(p,{class:"my-card",outlined:""},{default:a(()=>[e(x,{headers:t.headers,loading:t.loading,items:t.users,"sort-by":[{key:"company_name",order:"asc"}]},{top:a(()=>[e(V,{flat:""},{default:a(()=>[e(g,null,{default:a(()=>[d("Company")]),_:1}),e(C,{class:"mx-4",inset:"",vertical:""}),e(m),e(y,{modelValue:t.dialog,"onUpdate:modelValue":l[4]||(l[4]=n=>t.dialog=n),"max-width":"500px"},{activator:a(({props:n})=>[e(i,O({color:"primary",dark:"",class:"mb-2"},n),{default:a(()=>[d(" New Company ")]),_:2},1040)]),default:a(()=>[e(v,null,{default:a(()=>[e(h,null,{default:a(()=>[P("span",R,L(s.formTitle),1)]),_:1}),e(k,null,{default:a(()=>[e(_,null,{default:a(()=>[e(b,null,{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[e(c,{modelValue:t.editedItem.company_name,"onUpdate:modelValue":l[1]||(l[1]=n=>t.editedItem.company_name=n),label:" Name"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(c,{modelValue:t.editedItem.email,"onUpdate:modelValue":l[2]||(l[2]=n=>t.editedItem.email=n),label:"Email"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(c,{modelValue:t.editedItem.phone,"onUpdate:modelValue":l[3]||(l[3]=n=>t.editedItem.phone=n),label:"phone"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(m),e(i,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:a(()=>[d(" Cancel ")]),_:1},8,["onClick"]),e(i,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:a(()=>[d(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(y,{modelValue:t.dialogDelete,"onUpdate:modelValue":l[5]||(l[5]=n=>t.dialogDelete=n),"max-width":"500px"},{default:a(()=>[e(v,null,{default:a(()=>[e(h,{class:"text-h5"},{default:a(()=>[d("Are you sure you want to delete this item?")]),_:1}),e(f,null,{default:a(()=>[e(m),e(i,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:a(()=>[d("Cancel")]),_:1},8,["onClick"]),e(i,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:a(()=>[d("OK")]),_:1},8,["onClick"]),e(m)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":a(({item:n})=>[e(I,{size:"small",class:"me-2",onClick:w=>s.editItem(n)},{default:a(()=>[d(" mdi-pencil ")]),_:2},1032,["onClick"]),e(I,{size:"small",onClick:w=>s.deleteItem(n)},{default:a(()=>[d(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":a(()=>[e(i,{color:"primary",onClick:s.initialize},{default:a(()=>[d(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"])]),_:1})]),_:1})}const G=j(z,[["render",E],["__scopeId","data-v-be814caa"]]);export{G as default};
