import{_ as Q}from"./AppLayout-1oFFevTS.js";import{s as r,h as a,o as z,c as F,w as o,b as e,x as q,f as i,y as p,a as _,t as $,p as G,j as H}from"./app-aEMWqQcf.js";import J from"./Bill-W4mgybtv.js";import M from"./TenantInvoice-wp8UI7eT.js";import W from"./Excel-nFpj4glD.js";import{_ as X}from"./_plugin-vue_export-helper-x3n3nnut.js";const Y={components:{AppLayout:Q,bill:J,tenantinvoice:M,excel:W},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Tenant Name",align:"start",sortable:!1,key:"tenant_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Property ",key:"property.property_name"},{title:"Actions",key:"actions",sortable:!1}],selected:[],invoiceData:null,landlords:[],searchQuery:"",properties:[],tenants:[],tenant_name:[],property_id:[],units:[],bills:[],unit_id:"",editedIndex:-1,editedItem:{landlord_name:"",email:"",phone:""},defaultItem:{landlord_name:"",email:"",phone:"",tenant_name:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Tenant":"Edit Tenant"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize(),this.fetchProperties(),this.fetchUnits()},methods:{initialize(){r.get("/api/tenants").then(n=>{console.log("API Response:",n.data),this.tenants=n.data}).catch(n=>{console.error("API Error:",n)})},openBill(t){this.$refs.bill.show(t)},openTenantInvoice(t){this.$refs.tenantinvoice.show(t)},openExcel(t){this.$refs.excel.show(t)},tenantInvoice(t){const n="api/tenantInvoice/"+t.id,y={tenantId:this.tenantId};r.post(n,y).then(m=>{console.log("Invoice created:",m.data),this.invoiceData=m.data}).catch(m=>{console.error("Error creating invoice:",m)})},editItem(t){this.editedIndex=this.tenants.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.tenants.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/api/tenant/${this.editedItem.id}`).then(()=>{this.tenants.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/api/tenant/${this.editedItem.id}`,this.editedItem):t=r.post("/api/tenant",this.editedItem),t.then(n=>{this.editedIndex>-1?Object.assign(this.tenants[this.editedIndex],n.data.data):this.tenants.push(n.data.data),this.close()}).catch(n=>console.error("Saving error:",n))},performSearch(){this.loading=!0;const t="/api/landlords/search?query="+this.searchQuery;r.get(t).then(n=>{console.log("Search response:",n.data),this.tenants=n.data,this.loading=!1}).catch(n=>{console.error("Search error:",n),this.loading=!1})},fetchUnits(){r.get("api/units").then(n=>{console.log("units response:",n.data),this.units=n.data}).catch(n=>{console.error("failed to load units:",n)})},fetchProperties(){r.get("api/property").then(n=>{console.log("properties response:",n.data),this.properties=n.data}).catch(n=>{console.error("failed to load properties:",n)})}}},b=t=>(G("data-v-5cadfd40"),t=t(),H(),t),Z={class:"text-h5"},ee=b(()=>_("span",null," Create Invoice",-1)),te=b(()=>_("span",null,"Edit",-1)),oe=b(()=>_("span",null,"Assign Bills",-1)),ne=b(()=>_("span",null,"Delete",-1));function ae(t,n,y,m,le,s){const f=a("v-text-field"),k=a("v-container"),C=a("VCard"),P=a("v-toolbar-title"),w=a("v-divider"),h=a("v-spacer"),d=a("v-btn"),V=a("v-card-title"),u=a("v-col"),x=a("v-select"),D=a("v-file-input"),S=a("v-row"),L=a("v-card-text"),A=a("v-card-actions"),T=a("V-card"),U=a("v-dialog"),R=a("v-card"),E=a("v-toolbar"),v=a("v-icon"),I=a("v-tooltip"),N=a("v-data-table"),O=a("bill"),B=a("tenantinvoice"),j=a("excel"),K=a("AppLayout");return z(),F(K,null,{default:o(()=>[e(C,{class:"my-card"},{default:o(()=>[e(k,null,{default:o(()=>[e(f,{modelValue:t.searchQuery,"onUpdate:modelValue":n[0]||(n[0]=l=>t.searchQuery=l),label:"Search",onKeyup:q(s.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(C,{class:"my-card",outlined:""},{default:o(()=>[e(N,{"show-select":"",headers:t.headers,loading:t.loading,items:t.tenants,"sort-by":[{key:"tenant_name",order:"asc"}]},{top:o(()=>[e(E,null,{default:o(()=>[e(P,null,{default:o(()=>[i("Tenant")]),_:1}),e(w,{class:"mx-4",inset:"",vertical:""}),e(h),e(U,{modelValue:t.dialog,"onUpdate:modelValue":n[6]||(n[6]=l=>t.dialog=l),"max-width":"700px"},{activator:o(({props:l})=>[e(d,{color:"success",dark:"",class:"mb-2 mr-2",onClick:s.openExcel,"prepend-icon":"mdi-file-excel",variant:"outlined"},{default:o(()=>[i(" Import ")]),_:1},8,["onClick"]),e(d,{color:"primary",dark:"",class:"mb-2","prepend-icon":"mdi-send",variant:"outlined"},{default:o(()=>[i(" Invoice ")]),_:1}),e(d,{color:"primary",dark:"",class:"mb-2","prepend-icon":"mdi-email"},{default:o(()=>[i(" Invoice ")]),_:1}),e(d,p({color:"primary",dark:"",class:"mb-2"},l,{"prepend-icon":"mdi-plus",variant:"outlined"}),{default:o(()=>[i(" Tenant ")]),_:2},1040)]),default:o(()=>[e(T,null,{default:o(()=>[e(V,null,{default:o(()=>[_("span",Z,$(s.formTitle),1)]),_:1}),e(L,null,{default:o(()=>[e(k,null,{default:o(()=>[e(S,null,{default:o(()=>[e(u,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(f,{modelValue:t.editedItem.tenant_name,"onUpdate:modelValue":n[1]||(n[1]=l=>t.editedItem.tenant_name=l),label:"Tanant Name"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(f,{modelValue:t.editedItem.email,"onUpdate:modelValue":n[2]||(n[2]=l=>t.editedItem.email=l),label:"Email"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(f,{modelValue:t.editedItem.phone,"onUpdate:modelValue":n[3]||(n[3]=l=>t.editedItem.phone=l),label:"phone"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(x,{modelValue:t.editedItem.property_id,"onUpdate:modelValue":n[4]||(n[4]=l=>t.editedItem.property_id=l),items:t.properties,"item-title":"property_name",label:"Property Name","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"12",sm:"6",md:"4"},{default:o(()=>[e(x,{modelValue:t.editedItem.unit_id,"onUpdate:modelValue":n[5]||(n[5]=l=>t.editedItem.unit_id=l),items:t.units,"item-title":"unit_number",label:"Account Number","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(D,{label:"Select  file",accept:"pfd",onChange:t.uploadaAgreement},null,8,["onChange"])]),_:1})]),_:1})]),_:1}),e(A,null,{default:o(()=>[e(h),e(d,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:o(()=>[i(" Cancel ")]),_:1},8,["onClick"]),e(d,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:o(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{modelValue:t.dialogDelete,"onUpdate:modelValue":n[7]||(n[7]=l=>t.dialogDelete=l),"max-width":"500px"},{default:o(()=>[e(R,null,{default:o(()=>[e(V,{class:"text-h5"},{default:o(()=>[i("Are you sure you want to delete this item?")]),_:1}),e(A,null,{default:o(()=>[e(h),e(d,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:o(()=>[i("Cancel")]),_:1},8,["onClick"]),e(d,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:o(()=>[i("OK")]),_:1},8,["onClick"]),e(h)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":o(({item:l})=>[e(I,{location:"bottom"},{activator:o(({props:c})=>[e(d,p({icon:""},c,{onClick:g=>s.tenantInvoice(l),variant:"text"}),{default:o(()=>[e(v,{color:"info"},{default:o(()=>[i(" mdi-book ")]),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[ee]),_:2},1024),e(I,{location:"bottom"},{activator:o(({props:c})=>[e(d,p({icon:""},c,{onClick:g=>s.editItem(l),variant:"text"}),{default:o(()=>[e(v,{color:"info"},{default:o(()=>[i(" mdi-pencil ")]),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[te]),_:2},1024),e(I,{location:"bottom"},{activator:o(({props:c})=>[e(d,p({icon:""},c,{onClick:g=>s.openBill(l),variant:"text"}),{default:o(()=>[e(v,{color:"info"},{default:o(()=>[i(" mdi-cog ")]),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[oe]),_:2},1024),e(I,{location:"bottom"},{activator:o(({props:c})=>[e(d,p({icon:""},c,{onClick:g=>s.deleteItem(l),variant:"text"}),{default:o(()=>[e(v,{color:"error"},{default:o(()=>[i(" mdi-delete ")]),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[ne]),_:2},1024)]),"no-data":o(()=>[e(d,{color:"primary",onClick:s.initialize},{default:o(()=>[i(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(O,{ref:"bill"},null,512),e(B,{ref:"tenantinvoice"},null,512),e(j,{ref:"excel"},null,512)]),_:1})]),_:1})}const ue=X(Y,[["render",ae],["__scopeId","data-v-5cadfd40"]]);export{ue as default};
