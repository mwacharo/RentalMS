import{_ as z}from"./AppLayout-thM4_Dq7.js";import{h as u,i as a,o as B,c as Q,w as t,b as e,f as o,a as i,t as $,p as j,q as x}from"./app-HGAGYWQr.js";import F from"./Newcall-v1DCtyoL.js";import M from"./Filter--zaX6LEr.js";import{_ as O}from"./_plugin-vue_export-helper-x3n3nnut.js";const K={components:{AppLayout:z,newcall:F,filter:M},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Tenant Name",align:"start",sortable:!1,key:"tenant_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Property ",key:"property.property_name"}],selected:[],invoiceData:null,landlords:[],searchQuery:"",properties:[],tenants:[],tenant_name:[],property_id:[],units:[],bills:[],unit_id:"",editedIndex:-1,editedItem:{landlord_name:"",email:"",phone:""},defaultItem:{landlord_name:"",email:"",phone:"",tenant_name:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Tenant":"Edit Tenant"}},watch:{dialog(l){l||this.close()},dialogDelete(l){l||this.closeDelete()}},created(){this.initialize(),this.fetchProperties(),this.fetchUnits()},methods:{initialize(){u.get("/tenants").then(n=>{console.log("API Response:",n.data),this.tenants=n.data}).catch(n=>{console.error("API Error:",n)})},openNewCall(l){this.$refs.newcall.show(l)},openFilter(l){this.$refs.filter.show(l)},tenantInvoice(l){const n="tenantInvoice/"+l.id,g={tenantId:this.tenantId};u.post(n,g).then(m=>{console.log("Invoice created:",m.data),this.invoiceData=m.data}).catch(m=>{console.error("Error creating invoice:",m)})},save(){let l;this.editedIndex>-1?l=u.put(`/tenant/${this.editedItem.id}`,this.editedItem):l=u.post("/tenant",this.editedItem),l.then(n=>{this.editedIndex>-1?Object.assign(this.tenants[this.editedIndex],n.data.data):this.tenants.push(n.data.data),this.close()}).catch(n=>console.error("Saving error:",n))},performSearch(){this.loading=!0;const l="/landlords/search?query="+this.searchQuery;u.get(l).then(n=>{console.log("Search response:",n.data),this.tenants=n.data,this.loading=!1}).catch(n=>{console.error("Search error:",n),this.loading=!1})},fetchUnits(){u.get("units").then(n=>{console.log("units response:",n.data),this.units=n.data}).catch(n=>{console.error("failed to load units:",n)})},fetchProperties(){u.get("properties").then(n=>{console.log("properties response:",n.data),this.properties=n.data}).catch(n=>{console.error("failed to load properties:",n)})}}},c=l=>(j("data-v-ec3f6381"),l=l(),x(),l),G=c(()=>i("br",null,null,-1)),H=c(()=>i("br",null,null,-1)),J=c(()=>i("br",null,null,-1)),W=c(()=>i("br",null,null,-1)),X=c(()=>i("br",null,null,-1)),Y=c(()=>i("br",null,null,-1)),Z=c(()=>i("br",null,null,-1)),ee={class:"text-h5"},te={ref:"filter"};function le(l,n,g,m,ne,_){const r=a("v-icon"),p=a("v-card"),s=a("v-col"),f=a("v-spacer"),I=a("v-row"),C=a("VCard"),b=a("v-tab"),A=a("v-tabs"),v=a("v-text-field"),y=a("v-container"),P=a("v-toolbar-title"),L=a("v-divider"),V=a("v-card-title"),k=a("v-select"),S=a("v-file-input"),N=a("v-card-text"),h=a("v-btn"),w=a("v-card-actions"),R=a("V-card"),U=a("v-dialog"),D=a("v-toolbar"),T=a("v-data-table"),E=a("newcall"),q=a("AppLayout");return B(),Q(q,null,{default:t(()=>[e(C,{class:"my-card"},{default:t(()=>[e(I,{class:"my-4"},{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"pa-4"},{default:t(()=>[e(r,{onClick:_.openNewCall,class:"call-action",left:""},{default:t(()=>[o("mdi-phone")]),_:1},8,["onClick"]),o(" Make a new Call"),G,e(r,null,{default:t(()=>[o("mdi-account-supervisor")]),_:1}),o(" Call an agent"),H,e(r,null,{default:t(()=>[o("mdi-phone-missed")]),_:1}),o(" Missed Calls 26"),J,e(r,null,{default:t(()=>[o("mdi-format-list-checks")]),_:1}),o(" Check Queue"),W]),_:1})]),_:1}),e(f),e(s,null,{default:t(()=>[e(p,{class:"pa-4"},{default:t(()=>[e(r,null,{default:t(()=>[o(" mdi-phone")]),_:1}),o(" Calls made"),X,e(r,null,{default:t(()=>[o("mdi-phone-hangup")]),_:1}),o(" Calls rejected"),Y,e(r,null,{default:t(()=>[o("mdi-phone-incoming")]),_:1}),o(" Incoming Calls"),Z]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(A,{modelValue:l.tab,"onUpdate:modelValue":n[0]||(n[0]=d=>l.tab=d)},{default:t(()=>[e(b,{value:"tenants"},{default:t(()=>[o("Tenants")]),_:1}),e(b,{value:"landlords"},{default:t(()=>[o("Landlords")]),_:1}),e(b,{value:"calls"},{default:t(()=>[o("Calls")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:t(()=>[e(I,null,{default:t(()=>[e(s,null,{default:t(()=>[e(v,{required:"",id:"input-search",label:"Search Contact ( phone, name,property)","prepend-icon":"mdi-magnify","append-icon":"mdi-tune",onClick:_.openFilter,type:"text"},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(C,{class:"my-card",outlined:""},{default:t(()=>[e(T,{"show-select":"",headers:l.headers,loading:l.loading,items:l.tenants,"sort-by":[{key:"tenant_name",order:"asc"}]},{top:t(()=>[e(D,null,{default:t(()=>[e(P,null,{default:t(()=>[o("Tenant")]),_:1}),e(L,{class:"mx-4",inset:"",vertical:""}),e(f),e(U,{modelValue:l.dialog,"onUpdate:modelValue":n[6]||(n[6]=d=>l.dialog=d),"max-width":"700px"},{default:t(()=>[e(R,null,{default:t(()=>[e(V,null,{default:t(()=>[i("span",ee,$(_.formTitle),1)]),_:1}),e(N,null,{default:t(()=>[e(y,null,{default:t(()=>[e(I,null,{default:t(()=>[e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.tenant_name,"onUpdate:modelValue":n[1]||(n[1]=d=>l.editedItem.tenant_name=d),label:"Tanant Name"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.email,"onUpdate:modelValue":n[2]||(n[2]=d=>l.editedItem.email=d),label:"Email"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.phone,"onUpdate:modelValue":n[3]||(n[3]=d=>l.editedItem.phone=d),label:"phone"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(k,{modelValue:l.editedItem.property_id,"onUpdate:modelValue":n[4]||(n[4]=d=>l.editedItem.property_id=d),items:l.properties,"item-title":"property_name",label:"Property Name","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(k,{modelValue:l.editedItem.unit_id,"onUpdate:modelValue":n[5]||(n[5]=d=>l.editedItem.unit_id=d),items:l.units,"item-title":"unit_number",label:"Account Number","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(S,{label:"Select  file",accept:"pfd",onChange:l.uploadaAgreement},null,8,["onChange"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(f),e(h,{color:"blue-darken-1",variant:"text",onClick:l.close},{default:t(()=>[o(" Cancel ")]),_:1},8,["onClick"]),e(h,{color:"blue-darken-1",variant:"text",onClick:_.save},{default:t(()=>[o(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{modelValue:l.dialogDelete,"onUpdate:modelValue":n[7]||(n[7]=d=>l.dialogDelete=d),"max-width":"500px"},{default:t(()=>[e(p,null,{default:t(()=>[e(V,{class:"text-h5"},{default:t(()=>[o("Are you sure you want to delete this item?")]),_:1}),e(w,null,{default:t(()=>[e(f),e(h,{color:"blue-darken-1",variant:"text",onClick:l.closeDelete},{default:t(()=>[o("Cancel")]),_:1},8,["onClick"]),e(h,{color:"blue-darken-1",variant:"text",onClick:l.deleteItemConfirm},{default:t(()=>[o("OK")]),_:1},8,["onClick"]),e(f)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"no-data":t(()=>[e(h,{color:"primary",onClick:_.initialize},{default:t(()=>[o(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(E,{ref:"newcall"},null,512),i("filter",te,null,512)]),_:1})]),_:1})]),_:1})}const re=O(K,[["render",le],["__scopeId","data-v-ec3f6381"]]);export{re as default};
