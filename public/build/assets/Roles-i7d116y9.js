import{_ as A}from"./AppLayout-jx6QWEP9.js";import S from"./RolePermissions-2lmDz9g_.js";import{h as r,i as a,o as N,c as O,w as o,b as e,j as U,f as n,m as k,a as z,t as L,v as j}from"./app-37DS2Gtf.js";import{_ as K}from"./_plugin-vue_export-helper-x3n3nnut.js";const Q={components:{AppLayout:A,RolesPermissions:S},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:" Name",align:"start",sortable:!1,key:"name"},{title:"Actions",key:"actions",sortable:!1}],roles:[],searchQuery:"",editedIndex:-1,editedItem:{name:"",email:"",phone:""},defaultItem:{name:"",email:"",phone:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Role":"Edit Role"}},watch:{dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){r.get("/v1/roles").then(l=>{console.log("API Response:",l.data),this.roles=l.data}).catch(l=>{console.error("API Error:",l)})},managePermissions(t){this.$refs.RolesPermissionsComponent.showDialog(t.id)},editItem(t){this.editedIndex=this.roles.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.roles.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){r.delete(`/v1/roles/${this.editedItem.id}`).then(()=>{this.roles.splice(this.editedIndex,1),this.closeDelete()}).catch(t=>console.error("Deletion error:",t))},close(){this.dialog=!1,this.resetForm()},closeDelete(){this.dialogDelete=!1,this.resetForm()},resetForm(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){let t;this.editedIndex>-1?t=r.put(`/v1/roles/${this.editedItem.id}`,this.editedItem):t=r.post("/v1/roles",this.editedItem),t.then(l=>{this.editedIndex>-1?Object.assign(this.roles[this.editedIndex],l.data.data):this.roles.push(l.data.data),this.close()}).catch(l=>console.error("Saving error:",l)),this.close()},performSearch(){this.loading=!0;const t="/roles/search?query="+this.searchQuery;r.get(t).then(l=>{console.log("Search response:",l.data),this.roles=l.data,this.loading=!1}).catch(l=>{console.error("Search error:",l),this.loading=!1})}}},B={class:"text-h5"};function F(t,l,T,q,E,i){const u=a("v-text-field"),_=a("v-container"),h=a("VCard"),C=a("v-toolbar-title"),b=a("v-divider"),c=a("v-spacer"),d=a("v-btn"),f=a("v-card-title"),y=a("v-col"),x=a("v-row"),V=a("v-card-text"),p=a("v-card-actions"),v=a("v-card"),g=a("v-dialog"),R=a("v-toolbar"),m=a("v-icon"),D=a("v-data-table"),P=a("RolesPermissions"),w=a("AppLayout");return N(),O(w,null,{default:o(()=>[e(h,{class:"my-card"},{default:o(()=>[e(_,null,{default:o(()=>[e(u,{modelValue:t.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=s=>t.searchQuery=s),label:"Search",onKeyup:U(i.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(h,{class:"my-card",outlined:""},{default:o(()=>[e(D,{headers:t.headers,loading:t.loading,items:t.roles,"sort-by":[{key:"name",order:"asc"}]},{top:o(()=>[e(R,{flat:""},{default:o(()=>[e(C,null,{default:o(()=>[n("Role")]),_:1}),e(b,{class:"mx-4",inset:"",vertical:""}),e(c),e(g,{modelValue:t.dialog,"onUpdate:modelValue":l[2]||(l[2]=s=>t.dialog=s),"max-width":"500px"},{activator:o(({props:s})=>[e(d,k({color:"primary",dark:"",class:"mb-2"},s),{default:o(()=>[n(" New Role ")]),_:2},1040)]),default:o(()=>[e(v,null,{default:o(()=>[e(f,null,{default:o(()=>[z("span",B,L(i.formTitle),1)]),_:1}),e(V,null,{default:o(()=>[e(_,null,{default:o(()=>[e(x,null,{default:o(()=>[e(y,{cols:"12"},{default:o(()=>[e(u,{modelValue:t.editedItem.name,"onUpdate:modelValue":l[1]||(l[1]=s=>t.editedItem.name=s),label:" Name"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(c),e(d,{color:"blue-darken-1",variant:"text",onClick:i.close},{default:o(()=>[n(" Cancel ")]),_:1},8,["onClick"]),e(d,{color:"blue-darken-1",variant:"text",onClick:i.save},{default:o(()=>[n(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(g,{modelValue:t.dialogDelete,"onUpdate:modelValue":l[3]||(l[3]=s=>t.dialogDelete=s),"max-width":"500px"},{default:o(()=>[e(v,null,{default:o(()=>[e(f,{class:"text-h5"},{default:o(()=>[n("Are you sure you want to delete this item?")]),_:1}),e(p,null,{default:o(()=>[e(c),e(d,{color:"blue-darken-1",variant:"text",onClick:i.closeDelete},{default:o(()=>[n("Cancel")]),_:1},8,["onClick"]),e(d,{color:"blue-darken-1",variant:"text",onClick:i.deleteItemConfirm},{default:o(()=>[n("OK")]),_:1},8,["onClick"]),e(c)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":o(({item:s})=>[e(m,k(t.attrs,j(t.on),{size:"large",color:"primary",class:"me-2",onClick:I=>i.managePermissions(s)}),{default:o(()=>[n(" mdi-account-key ")]),_:2},1040,["onClick"]),e(m,{size:"small",class:"me-2",onClick:I=>i.editItem(s)},{default:o(()=>[n(" mdi-pencil ")]),_:2},1032,["onClick"]),e(m,{size:"small",onClick:I=>i.deleteItem(s)},{default:o(()=>[n(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[e(d,{color:"primary",onClick:i.initialize},{default:o(()=>[n(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(P,{ref:"RolesPermissionsComponent"},null,512)]),_:1})]),_:1})}const M=K(Q,[["render",F],["__scopeId","data-v-926b5523"]]);export{M as default};
