import{_ as q}from"./AppLayout-PU2Nz2pZ.js";import{m as u,h as n,o as z,c as B,w as t,b as e,f as o,a as i,t as Q,p as $,j as x}from"./app-5VpZBQ26.js";import F from"./Newcall-5ncp3Y8t.js";import M from"./Filter-Xf7zHFMM.js";import{_ as O}from"./_plugin-vue_export-helper-x3n3nnut.js";const K={components:{AppLayout:q,newcall:F,filter:M},data:()=>({dialog:!1,loading:!1,dialogDelete:!1,headers:[{title:"Tenant Name",align:"start",sortable:!1,key:"tenant_name"},{title:"Email",key:"email"},{title:"Phone",key:"phone"},{title:"Property ",key:"property.property_name"}],selected:[],invoiceData:null,landlords:[],searchQuery:"",properties:[],tenants:[],tenant_name:[],property_id:[],units:[],bills:[],unit_id:"",editedIndex:-1,editedItem:{landlord_name:"",email:"",phone:""},defaultItem:{landlord_name:"",email:"",phone:"",tenant_name:"",property_id:""}}),computed:{formTitle(){return this.editedIndex===-1?"New Tenant":"Edit Tenant"}},watch:{dialog(l){l||this.close()},dialogDelete(l){l||this.closeDelete()}},created(){this.initialize(),this.fetchProperties(),this.fetchUnits()},methods:{initialize(){u.get("/api/tenants").then(a=>{console.log("API Response:",a.data),this.tenants=a.data}).catch(a=>{console.error("API Error:",a)})},openNewCall(l){this.$refs.newcall.show(l)},openFilter(l){this.$refs.filter.show(l)},tenantInvoice(l){const a="api/tenantInvoice/"+l.id,g={tenantId:this.tenantId};u.post(a,g).then(m=>{console.log("Invoice created:",m.data),this.invoiceData=m.data}).catch(m=>{console.error("Error creating invoice:",m)})},save(){let l;this.editedIndex>-1?l=u.put(`/api/tenant/${this.editedItem.id}`,this.editedItem):l=u.post("/api/tenant",this.editedItem),l.then(a=>{this.editedIndex>-1?Object.assign(this.tenants[this.editedIndex],a.data.data):this.tenants.push(a.data.data),this.close()}).catch(a=>console.error("Saving error:",a))},performSearch(){this.loading=!0;const l="/api/landlords/search?query="+this.searchQuery;u.get(l).then(a=>{console.log("Search response:",a.data),this.tenants=a.data,this.loading=!1}).catch(a=>{console.error("Search error:",a),this.loading=!1})},fetchUnits(){u.get("api/units").then(a=>{console.log("units response:",a.data),this.units=a.data}).catch(a=>{console.error("failed to load units:",a)})},fetchProperties(){u.get("api/property").then(a=>{console.log("properties response:",a.data),this.properties=a.data}).catch(a=>{console.error("failed to load properties:",a)})}}},c=l=>($("data-v-b6b03e51"),l=l(),x(),l),G=c(()=>i("br",null,null,-1)),H=c(()=>i("br",null,null,-1)),J=c(()=>i("br",null,null,-1)),W=c(()=>i("br",null,null,-1)),X=c(()=>i("br",null,null,-1)),Y=c(()=>i("br",null,null,-1)),Z=c(()=>i("br",null,null,-1)),ee={class:"text-h5"},te={ref:"filter"};function le(l,a,g,m,ae,_){const r=n("v-icon"),p=n("v-card"),s=n("v-col"),f=n("v-spacer"),b=n("v-row"),C=n("VCard"),I=n("v-tab"),A=n("v-tabs"),v=n("v-text-field"),y=n("v-container"),P=n("v-toolbar-title"),L=n("v-divider"),V=n("v-card-title"),k=n("v-select"),S=n("v-file-input"),N=n("v-card-text"),h=n("v-btn"),w=n("v-card-actions"),R=n("V-card"),U=n("v-dialog"),D=n("v-toolbar"),T=n("v-data-table"),E=n("newcall"),j=n("AppLayout");return z(),B(j,null,{default:t(()=>[e(C,{class:"my-card"},{default:t(()=>[e(b,{class:"my-4"},{default:t(()=>[e(s,null,{default:t(()=>[e(p,{class:"pa-4"},{default:t(()=>[e(r,{onClick:_.openNewCall,class:"call-action",left:""},{default:t(()=>[o("mdi-phone")]),_:1},8,["onClick"]),o(" Make a new Call"),G,e(r,null,{default:t(()=>[o("mdi-account-supervisor")]),_:1}),o(" Call an agent"),H,e(r,null,{default:t(()=>[o("mdi-phone-missed")]),_:1}),o(" Missed Calls 26"),J,e(r,null,{default:t(()=>[o("mdi-format-list-checks")]),_:1}),o(" Check Queue"),W]),_:1})]),_:1}),e(f),e(s,null,{default:t(()=>[e(p,{class:"pa-4"},{default:t(()=>[e(r,null,{default:t(()=>[o(" mdi-phone")]),_:1}),o(" Calls made"),X,e(r,null,{default:t(()=>[o("mdi-phone-hangup")]),_:1}),o(" Calls rejected"),Y,e(r,null,{default:t(()=>[o("mdi-phone-incoming")]),_:1}),o(" Incoming Calls"),Z]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(A,{modelValue:l.tab,"onUpdate:modelValue":a[0]||(a[0]=d=>l.tab=d)},{default:t(()=>[e(I,{value:"tenants"},{default:t(()=>[o("Tenants")]),_:1}),e(I,{value:"landlords"},{default:t(()=>[o("Landlords")]),_:1}),e(I,{value:"calls"},{default:t(()=>[o("Calls")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:t(()=>[e(b,null,{default:t(()=>[e(s,null,{default:t(()=>[e(v,{required:"",id:"input-search",label:"Search Contact ( phone, name,property)","prepend-icon":"mdi-magnify","append-icon":"mdi-tune",onClick:_.openFilter,type:"text"},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(C,{class:"my-card",outlined:""},{default:t(()=>[e(T,{"show-select":"",headers:l.headers,loading:l.loading,items:l.tenants,"sort-by":[{key:"tenant_name",order:"asc"}]},{top:t(()=>[e(D,null,{default:t(()=>[e(P,null,{default:t(()=>[o("Tenant")]),_:1}),e(L,{class:"mx-4",inset:"",vertical:""}),e(f),e(U,{modelValue:l.dialog,"onUpdate:modelValue":a[6]||(a[6]=d=>l.dialog=d),"max-width":"700px"},{default:t(()=>[e(R,null,{default:t(()=>[e(V,null,{default:t(()=>[i("span",ee,Q(_.formTitle),1)]),_:1}),e(N,null,{default:t(()=>[e(y,null,{default:t(()=>[e(b,null,{default:t(()=>[e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.tenant_name,"onUpdate:modelValue":a[1]||(a[1]=d=>l.editedItem.tenant_name=d),label:"Tanant Name"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.email,"onUpdate:modelValue":a[2]||(a[2]=d=>l.editedItem.email=d),label:"Email"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(v,{modelValue:l.editedItem.phone,"onUpdate:modelValue":a[3]||(a[3]=d=>l.editedItem.phone=d),label:"phone"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(k,{modelValue:l.editedItem.property_id,"onUpdate:modelValue":a[4]||(a[4]=d=>l.editedItem.property_id=d),items:l.properties,"item-title":"property_name",label:"Property Name","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(k,{modelValue:l.editedItem.unit_id,"onUpdate:modelValue":a[5]||(a[5]=d=>l.editedItem.unit_id=d),items:l.units,"item-title":"unit_number",label:"Account Number","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(S,{label:"Select  file",accept:"pfd",onChange:l.uploadaAgreement},null,8,["onChange"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(f),e(h,{color:"blue-darken-1",variant:"text",onClick:l.close},{default:t(()=>[o(" Cancel ")]),_:1},8,["onClick"]),e(h,{color:"blue-darken-1",variant:"text",onClick:_.save},{default:t(()=>[o(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{modelValue:l.dialogDelete,"onUpdate:modelValue":a[7]||(a[7]=d=>l.dialogDelete=d),"max-width":"500px"},{default:t(()=>[e(p,null,{default:t(()=>[e(V,{class:"text-h5"},{default:t(()=>[o("Are you sure you want to delete this item?")]),_:1}),e(w,null,{default:t(()=>[e(f),e(h,{color:"blue-darken-1",variant:"text",onClick:l.closeDelete},{default:t(()=>[o("Cancel")]),_:1},8,["onClick"]),e(h,{color:"blue-darken-1",variant:"text",onClick:l.deleteItemConfirm},{default:t(()=>[o("OK")]),_:1},8,["onClick"]),e(f)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"no-data":t(()=>[e(h,{color:"primary",onClick:_.initialize},{default:t(()=>[o(" Reset ")]),_:1},8,["onClick"])]),_:1},8,["headers","loading","items"]),e(E,{ref:"newcall"},null,512),i("filter",te,null,512)]),_:1})]),_:1})]),_:1})}const re=O(K,[["render",le],["__scopeId","data-v-b6b03e51"]]);export{re as default};
